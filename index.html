<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>iOS Models List</title>
    <meta name="description" content="The ultimate list of iOS device models.">
    <style type="text/css">
        * {
            font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
        }
        .container {
            margin: 0 auto;
            width: 60%;
        }
        textarea#list, textarea#dict {
            height: 10em;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class='container'>
        <h2>iOS Models List</h2>

        <p>list.json:</p>
        <textarea id='list'></textarea>
        <p>NSDictionary:</p>
        <textarea id='dict'></textarea>

        <p><center>GitHub: <a href="https://github.com/ElfSundae/iOS-Models-List">ElfSundae/iOS-Models-List</a></center></p>
    </div>

<script>
    function parseDevicesResponse(data)
    {
        var list = {};
        const collator = new Intl.Collator('en', { numeric: true, sensitivity: 'base' });
        data.sort((a, b) => collator.compare(a.identifier, b.identifier));
        data.forEach(function(device) {
            if (device.identifier.startsWith('AudioAccessory')) {
                // exclude HomePod
                return;
            }

            let name = device.name
                .replace('Apple TV 2G', 'Apple TV 2')
                .replace(/^iPad 1$/, 'iPad')
                .replace('iPad Mini', 'iPad mini')
                .replace('iPad Pro 9.7-inch', 'iPad Pro (9.7-inch)')
                .replace('iPad Pro 12.9-inch', 'iPad Pro (12.9-inch)')
                .replace('iPad Pro (10.5-inch', 'iPad Pro 2 (10.5-inch')
                .replace('iPhone 2G', 'iPhone')
                .replace('iPhone 4 (GSM / 2012)', 'iPhone 4')
                .replace('[S]', 'S') // iPhone 3G[S], iPhone 4[S]
                .replace('+', ' Plus') // iPhone 6+, iPhone 6s+
                .replace('iPod touch 1G', 'iPod touch')
                .replace('iPod touch 2G', 'iPod touch 2')
                .replace(/[\s,]*(2013|2015|WiFi|GSM|CDMA|Mid 2012|Global|Cellular|China|1TB Model|LTE)/gi, '')
                .replace(/\s+\(\s*\)/g, '')
                .trim();

            list[device.identifier] = name;
        });

        return list;
    }

    fetch('https://api.ipsw.me/v4/devices')
    .then(response => response.json())
    .catch(error => alert(error))
    .then(function(data) {
        let list = parseDevicesResponse(data);
        document.querySelector('#list').value = JSON.stringify(list, null, 2);

        var dict = '';
        for (let key in list) {
            dict += `@"${key}": @"${list[key]}",\n`;
        }
        document.querySelector('#dict').value = dict;
    });
</script>
</body>
</html>
